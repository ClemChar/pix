<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Turn off caching because during development we'll change this file a lot -->
  <meta http-equiv="cache-control" content="max-age=0" />
  <meta http-equiv="cache-control" content="no-cache" />
  <meta http-equiv="expires" content="0" />
  <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
  <meta http-equiv="pragma" content="no-cache" />

  <!-- Title -->
  <title>Test Algo</title>

  <!-- Latest compiled and minified CSS & JS for Boostrap 3 -->
  <link rel="stylesheet" media="screen" href="http://netdna.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
  <script src="http://code.jquery.com/jquery.js"></script>
  <script src="http://netdna.bootstrapcdhttp:n.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
  <!-- ChartJS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.bundle.min.js"></script>
  <!-- Data -->
  <script id="data" type="application/json" src="./test_rece6jYwH4WEw549z_FULLOK_20190805-1508.json"></script>

</head>

<body>

<div class="container">

  <div class="page-header">
    <h1>Pix<small>algo</small></h1>
  </div>


  <div class="panel panel-default">
    <div class="panel-heading">
      <h3 class="panel-title">Experience d'un utilisateur</h3>
    </div>
    <div class="panel-body">
      <canvas id="bar-graph" style="width:50%">
        <!-- 50% width to fit -->
      </canvas>
    </div>
  </div>



</div>

<script>

  function loadJSON(file, callback) {

    var xobj = new XMLHttpRequest();
    xobj.overrideMimeType("application/json");
    xobj.open('GET', file, true); // Replace 'my_data' with the path to your file
    xobj.onreadystatechange = function () {
      if (xobj.readyState == 4 && xobj.status == "200") {
        // Required use of an anonymous callback as .open will NOT return a value but simply returns undefined in asynchronous mode
        callback(xobj.responseText);
      }
    };
    xobj.send(null);
  }

  loadJSON('./test_rece6jYwH4WEw549z_RANDOM_201908050334.json', function(response) {

    var dataJSON = JSON.parse(response);
    const levelEstimated = dataJSON.map(response => response.estimatedLevel);
    const levelChallenges = dataJSON.map(response => response.levelOfChallenge);
    const label = dataJSON.map((response, index) => `Epreuve ${index+1}`);
    const color = dataJSON.map((response)=> response.responseOfUser === 1 ? 'blue' : 'red');

    var barGraph = new Chart($('#bar-graph'), {
      type: 'bar',
      data: {
        datasets: [
          {
            label: 'Niveau estime par Pix',
            data: levelEstimated,
            backgroundColor: 'rgba(0, 100, 0, 1)',
            borderColor: 'rgba(0, 100, 0, 0.5)',
            fill: false,
            type: 'line'
          },
          {
            label: 'Niveau des epreuves',
            data: levelChallenges,
            backgroundColor: color,
          }, ],
        labels: label
      },

      options: {
        scales: {
          yAxes: [{
            ticks: {
              beginAtZero: true // begin y axis at 0
            }
          }]
        }
      }
    });

  });

</script>

</body>

</html>
